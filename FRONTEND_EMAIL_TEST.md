# 前端邮箱验证功能测试指南

## 功能说明

已实现的功能：
1. ✅ 用户注册（邮箱验证码）
2. ✅ 忘记密码（邮箱验证码重置）

## 注册页面

### 访问路径
```
http://localhost:5555/auth/register
```

### 表单字段
1. **用户名**（必填）
   - 2-50个字符

2. **邮箱**（必填）
   - 必须是有效的邮箱格式
   - 用于接收验证码

3. **邮箱验证码**（必填）
   - 6位数字
   - 点击"发送验证码"按钮获取
   - 60秒倒计时，期间不能重复发送

4. **密码**（必填）
   - 6-20个字符
   - 显示密码强度

5. **确认密码**（必填）
   - 必须与密码一致

6. **同意协议**（必填）
   - 必须勾选

### 操作流程
1. 输入用户名
2. 输入邮箱
3. 点击"发送验证码"按钮
4. 查收邮件，获取6位验证码
5. 输入验证码
6. 设置密码
7. 确认密码
8. 勾选同意协议
9. 点击"注册"按钮

### 验证码规则
- 有效期：15分钟
- 格式：6位数字
- 发送间隔：60秒（前端限制）

## 忘记密码页面

### 访问路径
```
http://localhost:5555/auth/forget-password
```

### 表单字段
1. **邮箱**（必填）
   - 必须是已注册的邮箱

2. **邮箱验证码**（必填）
   - 6位数字
   - 点击"发送验证码"按钮获取
   - 60秒倒计时

3. **新密码**（必填）
   - 6-20个字符
   - 显示密码强度

4. **确认密码**（必填）
   - 必须与新密码一致

### 操作流程
1. 输入已注册的邮箱
2. 点击"发送验证码"按钮
3. 查收邮件，获取6位验证码
4. 输入验证码
5. 设置新密码
6. 确认新密码
7. 点击"重置密码"按钮

## 邮件内容

### 注册验证码邮件
- 主题：表单采集器 - 注册验证码
- 内容：包含6位数字验证码
- 有效期提示：15分钟

### 重置密码验证码邮件
- 主题：表单采集器 - 找回密码
- 内容：包含6位数字验证码
- 有效期提示：15分钟

## 错误提示

### 注册页面
- "请先输入邮箱" - 未输入邮箱就点击发送验证码
- "请输入有效的邮箱地址" - 邮箱格式不正确
- "该邮箱已注册" - 邮箱已被使用
- "验证码已过期或不存在" - 验证码超过15分钟
- "验证码错误" - 输入的验证码不正确
- "发送验证码失败" - 邮件发送失败

### 忘记密码页面
- "该邮箱未注册" - 邮箱不存在
- 其他错误提示同注册页面

## 测试步骤

### 1. 测试注册功能

#### 正常流程
```bash
1. 访问 http://localhost:5555/auth/register
2. 输入用户名：测试用户
3. 输入邮箱：test@example.com
4. 点击"发送验证码"
5. 查收邮件（检查邮箱配置是否正确）
6. 输入收到的6位验证码
7. 输入密码：123456
8. 确认密码：123456
9. 勾选同意协议
10. 点击"注册"
11. 应该跳转到登录页面
```

#### 异常测试
- 邮箱格式错误：输入 "test" 点击发送验证码
- 验证码错误：输入 "000000"
- 密码不一致：密码和确认密码输入不同
- 未勾选协议：不勾选协议点击注册

### 2. 测试忘记密码功能

#### 正常流程
```bash
1. 访问 http://localhost:5555/auth/forget-password
2. 输入已注册的邮箱
3. 点击"发送验证码"
4. 查收邮件
5. 输入收到的6位验证码
6. 输入新密码：newpass123
7. 确认新密码：newpass123
8. 点击"重置密码"
9. 应该跳转到登录页面
10. 使用新密码登录验证
```

#### 异常测试
- 未注册邮箱：输入不存在的邮箱
- 验证码错误：输入错误的验证码
- 密码不一致：新密码和确认密码不同

### 3. 测试倒计时功能
```bash
1. 点击"发送验证码"
2. 观察按钮变为"60秒后重试"
3. 按钮应该禁用
4. 倒计时结束后按钮恢复为"发送验证码"
5. 可以再次点击发送
```

## 前端特性

### UI 交互
- ✅ 发送验证码按钮带倒计时（60秒）
- ✅ 发送中显示 loading 状态
- ✅ 倒计时期间按钮禁用
- ✅ 密码强度显示
- ✅ 实时表单验证
- ✅ 友好的错误提示

### 表单验证
- ✅ 邮箱格式验证
- ✅ 验证码格式验证（6位数字）
- ✅ 密码长度验证（6-20字符）
- ✅ 密码一致性验证
- ✅ 必填项验证

## 注意事项

1. **邮箱配置**
   - 确保后端 `config.local.json` 中的邮箱配置正确
   - SMTP 端口和密码要正确

2. **验证码有效期**
   - 后端：15分钟
   - 前端倒计时：60秒（仅限制发送频率）

3. **测试邮箱**
   - 建议使用真实邮箱测试
   - 检查垃圾邮件文件夹

4. **开发环境**
   - 前端：http://localhost:5555
   - 后端：http://localhost:80
   - API 前缀：/server/formCollector

## 常见问题

### Q: 收不到验证码邮件？
A: 检查：
1. 后端邮箱配置是否正确
2. SMTP 密码是否是授权码（不是邮箱密码）
3. 查看后端日志是否有错误
4. 检查邮箱的垃圾邮件文件夹

### Q: 验证码总是提示错误？
A: 检查：
1. 验证码是否过期（15分钟）
2. 是否输入了正确的6位数字
3. 是否有多余的空格

### Q: 注册成功但无法登录？
A: 检查：
1. 登录接口是否支持邮箱登录
2. 密码是否正确
3. 用户是否被禁用

## 后续优化建议

1. 添加图形验证码（防止机器人）
2. 添加邮箱唯一性实时检查
3. 支持手机号注册
4. 添加社交账号登录
5. 优化邮件模板样式
6. 添加注册成功欢迎邮件
